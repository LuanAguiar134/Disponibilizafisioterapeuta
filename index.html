<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>DisponibilizaFisio</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: Arial, sans-serif;
    }
    body {
      margin: 0;
      padding: 0;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    .login-container {
      background: #ffffff;
      padding: 40px 30px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
      width: 100%;
      max-width: 400px;
    }
    h2 {
      text-align: center;
      color: #333;
      margin-bottom: 25px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      color: #333;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
    }
    button {
      width: 100%;
      padding: 12px;
      background-color: #FF6A00;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    button:hover {
      background-color: #e65c00;
    }
    .hidden {
      display: none;
    }
    .link {
      text-align: center;
      margin-top: 10px;
      font-size: 14px;
    }
    .painel-container {
      max-width: 600px;
      margin: 40px auto;
      padding: 30px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    .solicitacao {
      background:#f0f0f0;
      padding:10px;
      border-radius:5px;
      margin:10px 0;
    }
  </style>
</head>
<body>

  <!-- Tela de Login/Cadastro -->
  <div class="login-container" id="auth">
    <h2>DisponibilizaFisio</h2>

    <label for="tipo">Tipo de Usuário</label>
    <select id="tipo">
      <option value="paciente">Paciente</option>
      <option value="fisioterapeuta">Fisioterapeuta</option>
    </select>

    <label for="nome">Nome</label>
    <input type="text" id="nome" placeholder="Digite seu nome">

    <label for="telefone">Telefone</label>
    <input type="text" id="telefone" placeholder="(XX) XXXXX-XXXX">

    <label for="email">Email</label>
    <input type="email" id="email" placeholder="email@exemplo.com">

    <label for="senha">Senha</label>
    <input type="password" id="senha" placeholder="******">

    <label for="confirmarSenha">Confirmar Senha</label>
    <input type="password" id="confirmarSenha" placeholder="******">

    <div id="areaFisio" class="hidden">
      <label>Área de Atuação</label>
      <select id="especialidade">
        <option>Acupuntura</option>
        <option>Aquática</option>
        <option>Cardiovascular</option>
        <option>Dermatofuncional</option>
        <option>Desportiva</option>
        <option>Do Trabalho</option>
        <option>Gerontologia</option>
        <option>Neurofuncional</option>
        <option>Oncologia</option>
        <option>Reumatologia</option>
        <option>Respiratória</option>
        <option>Traumato-Ortopédica</option>
        <option>Saúde da Mulher</option>
        <option>Terapia Intensiva</option>
        <option>Osteopatia</option>
        <option>Quiropraxia</option>
      </select>
    </div>

    <button onclick="cadastrar()">Cadastrar</button>

    <hr style="margin: 25px 0;">

    <label for="loginEmail">Email</label>
    <input type="email" id="loginEmail" placeholder="email@exemplo.com">

    <label for="loginSenha">Senha</label>
    <input type="password" id="loginSenha" placeholder="******">

    <button onclick="login()">Entrar</button>

    <div class="link"><a href="#">Esqueceu a senha?</a></div>
  </div>

  <!-- Painel Fisioterapeuta -->
  <div class="painel-container hidden" id="painelFisio">
    <h2>Bem-vindo, Fisioterapeuta!</h2>
    <p>Pacientes poderão encontrar você pela sua especialidade.</p>
    <h3>Solicitações recebidas:</h3>
    <div id="solicitacoes"></div>
    <button onclick="logout()">Sair</button>
  </div>

  <!-- Painel Paciente -->
  <div class="painel-container hidden" id="painelPaciente">
    <h2>Buscar Fisioterapeutas</h2>
    <label>Escolha uma especialidade</label>
    <select id="filtroArea"></select>
    <button onclick="buscarFisioterapeutas()">Buscar</button>
    <div id="listaFisio"></div>
    <button onclick="logout()">Sair</button>
  </div>

  <script>
    let usuarios = JSON.parse(localStorage.getItem("usuarios") || "[]");
    let solicitacoes = JSON.parse(localStorage.getItem("solicitacoes") || "[]");
    let usuarioLogado = JSON.parse(localStorage.getItem("usuarioLogado") || "null");

    document.getElementById("tipo").addEventListener("change", (e) => {
      document.getElementById("areaFisio").classList.toggle("hidden", e.target.value !== "fisioterapeuta");
    });

    const preencherFiltro = () => {
      const areas = [
        "Acupuntura", "Aquática", "Cardiovascular", "Dermatofuncional",
        "Desportiva", "Do Trabalho", "Gerontologia", "Neurofuncional",
        "Oncologia", "Reumatologia", "Respiratória", "Traumato-Ortopédica",
        "Saúde da Mulher", "Terapia Intensiva", "Osteopatia", "Quiropraxia"
      ];
      const select = document.getElementById("filtroArea");
      select.innerHTML = areas.map(a => `<option>${a}</option>`).join("");
    };

    preencherFiltro();

    if (usuarioLogado) mostrarPainel();

    function cadastrar() {
      const tipo = document.getElementById("tipo").value;
      const nome = document.getElementById("nome").value.trim();
      const telefone = document.getElementById("telefone").value.trim();
      const email = document.getElementById("email").value.trim();
      const senha = document.getElementById("senha").value.trim();
      const confirmarSenha = document.getElementById("confirmarSenha").value.trim();
      const especialidade = tipo === "fisioterapeuta" ? document.getElementById("especialidade").value : null;

      if (!nome || !telefone || !email || !senha || !confirmarSenha) {
        alert("Preencha todos os campos.");
        return;
      }

      if (senha !== confirmarSenha) {
        alert("As senhas não coincidem.");
        return;
      }

      if (usuarios.find(u => u.email === email)) {
        alert("Email já cadastrado.");
        return;
      }

      const novoUsuario = { tipo, nome, telefone, email, senha, especialidade };
      usuarios.push(novoUsuario);
      localStorage.setItem("usuarios", JSON.stringify(usuarios));
      alert("Cadastro realizado com sucesso! Faça login.");
    }

    function login() {
      const email = document.getElementById("loginEmail").value.trim();
      const senha = document.getElementById("loginSenha").value.trim();
      const usuario = usuarios.find(u => u.email === email && u.senha === senha);

      if (!usuario) {
        alert("Email ou senha inválidos.");
        return;
      }

      usuarioLogado = usuario;
      localStorage.setItem("usuarioLogado", JSON.stringify(usuarioLogado));
      mostrarPainel();
    }

    function logout() {
      if (confirm("Deseja sair?")) {
        usuarioLogado = null;
        localStorage.removeItem("usuarioLogado");
        document.getElementById("auth").classList.remove("hidden");
        document.getElementById("painelFisio").classList.add("hidden");
        document.getElementById("painelPaciente").classList.add("hidden");
      }
    }

    function mostrarPainel() {
      document.getElementById("auth").classList.add("hidden");
      if (usuarioLogado.tipo === "fisioterapeuta") {
        document.getElementById("painelFisio").classList.remove("hidden");
        mostrarSolicitacoes();
      } else {
        document.getElementById("painelPaciente").classList.remove("hidden");
      }
    }

    function buscarFisioterapeutas() {
      const area = document.getElementById("filtroArea").value;
      const lista = document.getElementById("listaFisio");
      lista.innerHTML = "";

      const fisioterapeutas = usuarios.filter(
        u => u.tipo === "fisioterapeuta" && u.especialidade === area
      );

      if (fisioterapeutas.length === 0) {
        lista.innerHTML = "<p>Nenhum fisioterapeuta encontrado.</p>";
      } else {
        fisioterapeutas.forEach(f => {
          lista.innerHTML += `
            <div class="solicitacao">
              <p><strong>${f.nome}</strong> - ${f.telefone} [${f.especialidade}]</p>
              <button onclick="solicitarAtendimento('${f.email}')">Solicitar Atendimento</button>
            </div>
          `;
        });
      }
    }

    function solicitarAtendimento(emailFisio) {
      const jaSolicitou = solicitacoes.find(
        s => s.fisioEmail === emailFisio && s.pacienteEmail === usuarioLogado.email
      );

      if (jaSolicitou) {
        alert("Você já solicitou atendimento a este fisioterapeuta.");
        return;
      }

      solicitacoes.push({
        fisioEmail: emailFisio,
        pacienteNome: usuarioLogado.nome,
        pacienteTelefone: usuarioLogado.telefone,
        pacienteEmail: usuarioLogado.email
      });

      localStorage.setItem("solicitacoes", JSON.stringify(solicitacoes));
      alert("Solicitação enviada com sucesso!");
    }

    function mostrarSolicitacoes() {
      const area = document.getElementById("solicitacoes");
      const minhasSolicitacoes = solicitacoes.filter(
        s => s.fisioEmail === usuarioLogado.email
      );

      area.innerHTML = minhasSolicitacoes.length === 0
        ? "<p>Nenhuma solicitação recebida.</p>"
        : minhasSolicitacoes.map(s => `
            <div class="solicitacao">
              <strong>${s.pacienteNome}</strong><br>
              Telefone: ${s.pacienteTelefone}
            </div>`).join("");
    }
  </script>
</body>
</html>
